char = { !("(" | ")" | WHITESPACE | NEWLINE) ~ ANY }
name = @{ char+ }

var = { "def" ~ "(" ~ #var = name ~ ")" }
unsupported = _{ "<unsupported>" }
not = { "!" ~ expr }
and = { "(" ~ expr ~ "&" ~ expr ~ ("&" ~ expr)* ~ ")" }
or = { "(" ~ expr ~ "|" ~ expr ~ ("|" ~ expr)* ~ ")" }
expr = _{ var | unsupported | not | and | or }

comment = _{ "#" ~ (!NEWLINE ~ ANY)* }
line = _{ expr | comment }
file = _{ SOI ~ (line? ~ NEWLINE)* ~ line? ~ EOI }
WHITESPACE = _{ " " | "\t" }